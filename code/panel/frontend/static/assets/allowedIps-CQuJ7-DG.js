import{r as y,l as g,b as h,a as b,h as p,d as c,s as E,c as v,e as I}from"./main-CfrVZou3.js";import"./dataTables.bootstrap4-2CiN1ToA.js";y(function(){const a=document.getElementById("add-form"),e=document.getElementById("add-btn"),r=document.getElementById("add-restart-btn");function i(d,o=!1){d.disabled=!0,g(),o?a.querySelector('input[name="restart"]').value=1:a.querySelector('input[name="restart"]').value=0,a.submit()}e.addEventListener("click",function(){i(e)}),r.addEventListener("click",function(){i(r,!0)})});y(function(){const a=document.getElementById("updateModal"),e=document.getElementById("update-form"),r=document.getElementById("update-btn"),i=document.getElementById("update-restart-btn");a&&a.addEventListener("show.coreui.modal",o=>{const t=o.relatedTarget,n=t.getAttribute("data-endpoint-id"),s=t.getAttribute("data-id"),f=t.getAttribute("data-entry-value");e.querySelector('input[name="endpoint_id"]').value=n,e.querySelector('input[name="entry_id"]').value=s,e.querySelector('input[name="allowed_ip"]').value=f});function d(o,t=!1){o.disabled=!0,g();const n=e.querySelector('input[name="endpoint_id"]').value,s=e.querySelector('input[name="entry_id"]').value,f=`/endpoints/${n}/allowed-ips/${s}`,m=new FormData(e);m.delete("endpoint_id"),t?m.append("restart",1):m.append("restart",0),h("#update-form"),b(f,{method:"PATCH",redirect:"error",body:m}).then(l=>l.json().then(u=>({ok:l.ok,data:u}))).then(({ok:l,data:u})=>{if(p(),!l)throw new Error(u.error||"Error occurred");u.success?(E(u.success+". Page will refresh shortly..."),setTimeout(()=>{I()},2500)):u.redirect&&v(u.redirect),o.disabled=!1}).catch(l=>{p(),l.message==="Failed to fetch"?c("There is a problem with processing the request. Reload and try again."):c(l.message),o.disabled=!1})}r.addEventListener("click",function(){d(r)}),i.addEventListener("click",function(){d(i,!0)})});y(function(){const a=document.getElementById("deleteModal"),e=document.getElementById("delete-form"),r=document.getElementById("delete-btn");a&&a.addEventListener("show.coreui.modal",i=>{const d=i.relatedTarget,o=d.getAttribute("data-endpoint-id"),t=d.getAttribute("data-id");e.querySelector('input[name="endpoint_id"]').value=o,e.querySelector('input[name="entry_id"]').value=t,document.getElementById("delete-endpoint-name").textContent=d.getAttribute("data-endpoint-name")}),r.addEventListener("click",function(){r.disabled=!0,g();const i=e.querySelector('input[name="endpoint_id"]').value,d=e.querySelector('input[name="entry_id"]').value,o=`/endpoints/${i}/allowed-ips/${d}`;h("#delete-form"),document.getElementById("delete-endpoint-name").textContent="",b(o,{method:"DELETE",redirect:"error"}).then(t=>t.json().then(n=>({ok:t.ok,data:n}))).then(({ok:t,data:n})=>{if(p(),r.disabled=!1,n.is_removed){const s=document.querySelector(`#allowed-ip-table tr[data-id="${d}"]`);s&&s.parentNode.removeChild(s),n.error?c(n.error):E("Entry removed successfully.")}else n.redirect?v(n.redirect):n.error?c(n.error):c("Failed to remove the entry.")}).catch(t=>{p(),t.message==="Failed to fetch"?c("There is a problem with processing the request. Reload and try again."):c(t.message),r.disabled=!1})})});
