import{$ as m}from"./dataTables.bootstrap4-2CiN1ToA.js";import{r as u,l as f,a as p,h as c,b,s as g,c as h,d as l,e as y}from"./main-CfrVZou3.js";m(document).ready(function(){m(".table").DataTable({responsive:{details:{responsive:!0,type:"none",target:""}},order:[[0,"desc"]],language:{search:""}}),m(".dataTables_filter input").attr("placeholder","Search...")});u(function(){const n=document.getElementById("add-endpoint-form");if(!n)return;const i=document.getElementById("add-endpoint-btn"),d=n.getAttribute("action");n.addEventListener("submit",function(s){i.disabled=!0,s.preventDefault(),f();const a=new FormData(n);p(d,{method:"POST",redirect:"error",body:a}).then(r=>r.json().then(e=>({ok:r.ok,data:e}))).then(({ok:r,data:e})=>{if(c(),!r)throw new Error(e.error||"Error occurred");e.success?(m("#port_input").addClass("d-none"),b("#add-endpoint-form"),g(e.success)):e.redirect&&h(e.redirect),i.disabled=!1}).catch(r=>{c(),l(r.message),i.disabled=!1})})});u(function(){const n=document.getElementById("edit-endpoint-form");if(!n)return;const i=document.getElementById("edit-endpoint-btn"),d=document.getElementById("api-url"),s=document.getElementById("request-mode"),a=n.getAttribute("action");n.addEventListener("submit",function(r){i.disabled=!0,r.preventDefault(),f();const e=new FormData(n);p(a,{method:"PATCH",body:e,redirect:"error"}).then(t=>t.json().then(o=>({ok:t.ok,data:o}))).then(({ok:t,data:o})=>{if(c(),!t)throw new Error(o.error||"Error occurred");o.success?(b("#edit-endpoint-form"),s.value=o.request_mode,d.value=o.api_url,g(o.success)):o.redirect&&h(o.redirect),i.disabled=!1}).catch(t=>{c(),l(t.message),i.disabled=!1})})});u(function(){const n=document.getElementById("requestUpdateModal"),i=document.getElementById("endpoint-table"),d=document.getElementById("update-request-mode-form"),s=document.getElementById("update-request-mode-btn");i&&(n&&n.addEventListener("show.coreui.modal",a=>{const r=a.relatedTarget,e=r.getAttribute("data-id"),t=r.getAttribute("data-request");d.querySelector('select[name="request_mode"]').value=t,d.querySelector('input[name="endpoint_id"]').value=e}),s.addEventListener("click",function(){s.disabled=!0,f();const r=`/endpoints/${d.querySelector('input[name="endpoint_id"]').value}/mode`,e=new FormData(d);e.delete("endpoint_id"),d.querySelector('select[name="request_mode"]').value="",d.querySelector('input[name="endpoint_id"]').value="",p(r,{method:"PATCH",redirect:"error",body:e}).then(t=>t.json().then(o=>({ok:t.ok,data:o}))).then(({ok:t,data:o})=>{if(c(),!t)throw new Error(o.error||"Error occurred");o.success?(g(o.success+". Page will refresh shortly..."),setTimeout(()=>{y()},3e3)):o.redirect&&h(o.redirect),s.disabled=!1}).catch(t=>{c(),t.message==="Failed to fetch"?l("There is a problem with processing the request. Reload and try again."):l(t.message),s.disabled=!1})}))});u(function(){const n=document.getElementById("deleteModal"),i=document.getElementById("endpoint-table"),d=document.getElementById("delete-endpoint-form"),s=document.getElementById("delete-endpoint-btn");i&&(n&&n.addEventListener("show.coreui.modal",a=>{const r=a.relatedTarget,e=r.getAttribute("data-id");d.querySelector('input[name="endpoint_id"]').value=e,document.getElementById("delete-endpoint-name").textContent=r.getAttribute("data-name")}),s.addEventListener("click",function(){s.disabled=!0,f();const a=d.querySelector('input[name="endpoint_id"]').value,r=`/endpoints/${a}`;d.querySelector('input[name="endpoint_id"]').value="",document.getElementById("delete-endpoint-name").textContent="",p(r,{method:"DELETE",redirect:"error"}).then(e=>e.json().then(t=>({ok:e.ok,data:t}))).then(({ok:e,data:t})=>{if(c(),!e)throw new Error(t.error||"Error occurred");if(t.success){const o=document.querySelector(`#endpoint-table tr[data-id="${a}"]`);o&&o.parentNode.removeChild(o),g(t.success)}else t.redirect&&h(t.redirect);s.disabled=!1}).catch(e=>{c(),e.message==="Failed to fetch"?l("There is a problem with processing the request. Reload and try again."):l(e.message),s.disabled=!1})}))});u(function(){const n=document.getElementById("restartModal"),i=document.getElementById("endpoint-table"),d=document.getElementById("restart-form");i&&n&&n.addEventListener("show.coreui.modal",s=>{const a=s.relatedTarget,r=a.getAttribute("data-id");document.getElementById("restart-endpoint-name").textContent=a.getAttribute("data-name"),d.setAttribute("action",`/endpoints/${r}/restart`)})});u(function(){var n=document.getElementById("port_select");n&&n.addEventListener("change",function(){var i=this.value;let d=document.getElementById("port_input");console.log(i),i=="auto"?d.classList.add("d-none"):d.classList.remove("d-none")})});
