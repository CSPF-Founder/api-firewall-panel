import{r as y,l as g,b as h,a as E,h as p,d as c,s as b,c as v,e as I}from"./main-CfrVZou3.js";import"./dataTables.bootstrap4-2CiN1ToA.js";y(function(){const i=document.getElementById("add-form"),t=document.getElementById("add-btn"),r=document.getElementById("add-restart-btn");function a(d,o=!1){d.disabled=!0,g(),o?i.querySelector('input[name="restart"]').value=1:i.querySelector('input[name="restart"]').value=0,i.submit()}t.addEventListener("click",function(){a(t)}),r.addEventListener("click",function(){a(r,!0)})});y(function(){const i=document.getElementById("updateModal"),t=document.getElementById("update-form"),r=document.getElementById("update-btn"),a=document.getElementById("update-restart-btn");i&&i.addEventListener("show.coreui.modal",o=>{const e=o.relatedTarget,n=e.getAttribute("data-endpoint-id"),s=e.getAttribute("data-id"),f=e.getAttribute("data-entry-value");t.querySelector('input[name="endpoint_id"]').value=n,t.querySelector('input[name="entry_id"]').value=s,document.getElementById("updated-denied-token").innerHTML=f});function d(o,e=!1){o.disabled=!0,g();const n=t.querySelector('input[name="endpoint_id"]').value,s=t.querySelector('input[name="entry_id"]').value,f=`/endpoints/${n}/denied-tokens/${s}`,m=new FormData(t);m.delete("endpoint_id"),e?m.append("restart",1):m.append("restart",0),h("#update-form"),E(f,{method:"PATCH",redirect:"error",body:m}).then(l=>l.json().then(u=>({ok:l.ok,data:u}))).then(({ok:l,data:u})=>{if(p(),!l)throw new Error(u.error||"Error occurred");u.success?(b(u.success+". Page will refresh shortly..."),setTimeout(()=>{I()},4e3)):u.redirect&&v(u.redirect),o.disabled=!1}).catch(l=>{p(),l.message==="Failed to fetch"?c("There is a problem with processing the request. Reload and try again."):c(l.message),o.disabled=!1})}r.addEventListener("click",function(){d(r)}),a.addEventListener("click",function(){d(a,!0)})});y(function(){const i=document.getElementById("deleteModal"),t=document.getElementById("delete-form"),r=document.getElementById("delete-btn");i&&i.addEventListener("show.coreui.modal",a=>{const d=a.relatedTarget,o=d.getAttribute("data-endpoint-id"),e=d.getAttribute("data-id");t.querySelector('input[name="endpoint_id"]').value=o,t.querySelector('input[name="entry_id"]').value=e,document.getElementById("delete-endpoint-name").textContent=d.getAttribute("data-endpoint-name")}),r.addEventListener("click",function(){r.disabled=!0,g();const a=t.querySelector('input[name="endpoint_id"]').value,d=t.querySelector('input[name="entry_id"]').value,o=`/endpoints/${a}/denied-tokens/${d}`;h("#delete-form"),document.getElementById("delete-endpoint-name").textContent="",E(o,{method:"DELETE",redirect:"error"}).then(e=>e.json().then(n=>({ok:e.ok,data:n}))).then(({ok:e,data:n})=>{if(p(),r.disabled=!1,n.is_removed){const s=document.querySelector(`#denied-tokens-table tr[data-id="${d}"]`);s&&s.parentNode.removeChild(s),n.error?c(n.error):b("Entry removed successfully.")}else n.redirect?v(n.redirect):n.error?c(n.error):c("Failed to remove the entry.")}).catch(e=>{p(),e.message==="Failed to fetch"?c("There is a problem with processing the request. Reload and try again."):c(e.message),r.disabled=!1})})});
